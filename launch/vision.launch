<launch>
    <arg name="camera_image_topic" default="/camera/image_raw"/>
    <arg name="warped_image_topic" default="/warped_image"/>
    <arg name="homography_topic" default="/camera/camera_homography"/>
    <!-- debug: undistored camera image (not warped) -->
    <arg name="undistored_image_topic" default="/undistorted_image"/>

    <arg name="debug" default="false"/>
    <arg name="use_nodelet" default="false"/>
    <arg name="nodelet_manager" default=""/>

    <!-- road trajectory -->
    <arg name="road_trajectory_topic" default="/road_trajectory"/>

    <include file="$(find drive_ros_image_recognition)/warp_image.launch">
        <arg name="camera_image_topic" value="$(arg camera_image_topic)" />
        <arg name="warped_image_topic" value="$(arg warped_image_topic)" />
        <arg name="undistort_out" value="$(arg undistored_image_topic)" />
        <arg name="homography_topic" value="$(arg homography_topic)" />
        <arg name="debug" default="$(arg debug)"/>
        <arg name="use_nodelet" value="$(arg use_nodelet)"/>
        <arg name="nodelet_manager" default="$(arg nodelet_manager)"/>
    </include>

    <include file="$(find drive_ros_image_recognition)/road_detection.launch">
        <arg name="incoming_image" value="$(arg warped_image_topic)" />
        <arg name="road_trajectory_topic" value="$(arg road_trajectory_topic)" />
        <arg name="homography_topic" value="$(arg homography_topic)" />
        <arg name="debug" default="$(arg debug)"/>
        <arg name="use_nodelet" value="$(arg use_nodelet)"/>
        <arg name="nodelet_manager" default="$(arg nodelet_manager)"/>
    </include>

    <include file="$(find drive_ros_image_recognition)/street_crossing.launch">
        <arg name="incoming_image" value="$(arg warped_image_topic)" />
        <arg name="homography_topic" value="$(arg homography_topic)" />
        <arg name="debug" default="$(arg debug)"/>
        <arg name="use_nodelet" value="$(arg use_nodelet)"/>
        <arg name="nodelet_manager" default="$(arg nodelet_manager)"/>
    </include>
</launch>
